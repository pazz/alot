language: python

python:
  # We can add more version strings here when we support other python
  # versions.
  - "2.7"

addons:
  apt:
    packages:
      # The gpgme build files are needed by the gpgme python module.
      - libgpgme11-dev
      # The notmuch libs are needed to actually run alot.  The notmuch package
      # should pull the correct libs.
      - notmuch

install:
  # urwid needs to be installed first.  The installation of urwidtrees will
  # fail otherwise.
  # TODO This should be fixed upstream.
  - pip install urwid
  # Install alot and the dependencies it declares.
  - pip install .
  # Install sphinx for building the documentation of alot.
  - pip install sphinx
  # Prepare a minimal config file for the final test.
  - echo 'initial_command=call os._exit(0)' > conf

script:
  # Build the documentation for alot.
  - make -C docs html
  # Minimal test: Start alot in order to quit immediatly.
  - alot --config conf
